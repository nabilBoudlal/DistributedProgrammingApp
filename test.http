# Variabili Globali/Ambiente (ID predefiniti per test ripetibili)
@baseUrl = http://localhost:5055
@patient_id = aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee
@doctor_id = 11111111-2222-3333-4444-555555555555
@slot_id = 66666666-7777-8888-9999-aaaaaaaaaaaa
@appointment_id = bbbbbbbb-cccc-dddd-eeee-ffffffffffff
@booking_correlation_id = dddddddd-eeee-ffff-1111-222222222222 


---
## === SCENARIO DI TEST 1: GESTIONE PAZIENTI ===
#

### 1.1 Crea un nuovo paziente
POST {{baseUrl}}/Patient
Content-Type: application/json

{
  "patientId": "{{patient_id}}",
  "name": "Mario Rossi Paziente Fisso"
}

### 1.2 Recupera il paziente appena creato
GET {{baseUrl}}/Patient/{{patient_id}}
Accept: application/json


---
### === SCENARIO DI TEST 2: GESTIONE DOTTORI E DISPONIBILITÀ ===


### 2.1 Crea un nuovo dottore
POST {{baseUrl}}/api/Doctor
Content-Type: application/json

{
  "doctorId": "{{doctor_id}}",
  "name": "Dott. Bianchi Fisso",
  "specialization": "Cardiologia"
}

### 2.2 Recupera i dettagli del dottore
GET {{baseUrl}}/api/Doctor/{{doctor_id}}
Accept: application/json

### 2.3 Aggiorna il nome del dottore
PUT {{baseUrl}}/api/Doctor/{{doctor_id}}/name
Content-Type: application/json

{
  "name": "Dott. Bianco Aggiornato Fisso"
}

### 2.4 Aggiorna la specializzazione del dottore
PUT {{baseUrl}}/api/Doctor/{{doctor_id}}/specialization
Content-Type: application/json

{
  "specialization": "Neurologia Fissa"
}

### 2.5 Recupera il dottore aggiornato per verificare le modifiche
GET {{baseUrl}}/api/Doctor/{{doctor_id}}
Accept: application/json

### 2.6 Definisci slot di disponibilità per il dottore
POST {{baseUrl}}/api/Doctor/{{doctor_id}}/availability
Content-Type: application/json

[
  {
    "id": "{{slot_id}}",
    "start": "2025-08-15T09:00:00Z",
    "duration": "01:00:00",
    "isReserved": false
  },
  {
    "id": "77777777-8888-9999-aaaa-bbbbbbbbbbbb",
    "start": "2025-08-15T10:30:00Z",
    "duration": "00:30:00",
    "isReserved": false
  }
]

### 2.7 Recupera gli slot di disponibilità del dottore
GET {{baseUrl}}/api/Doctor/{{doctor_id}}/available-slots?from=2025-08-15T00:00:00Z&to=2025-08-16T00:00:00Z
Accept: application/json


---
#
# === SCENARIO DI TEST 3: FLUSSO DI BOOKING E CONFERMA/ANNULLAMENTO/COMPLETAMENTO APPUNTAMENTO ===
#

### 3.1 Richiedi la prenotazione di un appuntamento
POST {{baseUrl}}/api/Appointments/book
Content-Type: application/json

{
  "patientId": "{{patient_id}}",
  "doctorId": "{{doctor_id}}",
  "slotId": "{{slot_id}}",
  "appointmentId": "{{appointment_id}}",
  "correlationId": "{{booking_correlation_id}}",
  "appointmentTime": "2025-08-15T09:00:00Z",
  "duration": "00:30:00",
  "reasonForVisit": "Visita di controllo annuale fissa"
}

### 3.2 Recupera l'appuntamento appena prenotato
GET {{baseUrl}}/api/Appointments/{{appointment_id}}
Accept: application/json

### 3.3 Conferma l'appuntamento
POST {{baseUrl}}/api/Appointments/{{appointment_id}}/confirm
Content-Type: application/json

{
  "appointmentId": "{{appointment_id}}",
  "correlationId": "{{booking_correlation_id}}"
}

### 3.4 Recupera l'appuntamento dopo la conferma
GET {{baseUrl}}/api/Appointments/{{appointment_id}}
Accept: application/json

### 3.5 Recupera tutti gli appuntamenti associati al paziente
GET {{baseUrl}}/Patient/{{patient_id}}/appointments
Accept: application/json


---
### === SCENARIO DI TEST 4: OPERAZIONI DI STATO DELL'APPUNTAMENTO (Cancel & Complete) ===

### 4.1 Annulla l'appuntamento
POST {{baseUrl}}/api/Appointments/{{appointment_id}}/cancel
Content-Type: application/json

{
  "appointmentId": "{{appointment_id}}",
  "correlationId": "{{booking_correlation_id}}"
}

### 4.2 Recupera l'appuntamento dopo l'annullamento
GET {{baseUrl}}/api/Appointments/{{appointment_id}}
Accept: application/json

### 4.3 Tentativo di completare un appuntamento annullato (non dovrebbe cambiare lo stato)
POST {{baseUrl}}/api/Appointments/{{appointment_id}}/complete
Content-Type: application/json

{
  "appointmentId": "{{appointment_id}}",
  "correlationId": "{{booking_correlation_id}}"
}

### 4.4 Recupera appuntamento dopo tentativo di completamento
GET {{baseUrl}}/api/Appointments/{{appointment_id}}
Accept: application/json


---
### === SCENARIO DI TEST 5: ELIMINAZIONE FINALE DELL'APPUNTAMENTO ===


### 5.1 Elimina l'appuntamento
DELETE {{baseUrl}}/api/Appointments/{{appointment_id}}
Content-Type: application/json

{
  "appointmentId": "{{appointment_id}}",
  "correlationId": "{{booking_correlation_id}}"
}

### 5.2 Tenta di recuperare l'appuntamento eliminato (dovrebbe fallire - 404 Not Found)
GET {{baseUrl}}/api/Appointments/{{appointment_id}}
Accept: application/json

### 5.3 Recupera tutti gli appuntamenti associati al paziente (dovrebbe essere vuoto)
GET {{baseUrl}}/Patient/{{patient_id}}/appointments
Accept: application/json


---
